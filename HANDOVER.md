# 引き継ぎガイド

このドキュメントは、開発者から納品先への完全な引き継ぎ手順を説明します。

## 📋 引き継ぎ前の準備

### 開発者側で確認すること

- [ ] ソースコードがGitHubにプッシュされている
- [ ] ドキュメントが最新である
- [ ] テストユーザーが作成されている
- [ ] スプレッドシートの構造が正しい
- [ ] 環境変数のリストが整理されている

### 納品先に提供するもの

1. **GitHubリポジトリのURL**
   - リポジトリへのアクセス権限を付与
   - または、リポジトリを納品先のアカウントに移譲

2. **ドキュメント一式**
   - `README.md` - 基本ドキュメント
   - `SETUP.md` - セットアップガイド
   - `DELIVERY.md` - 納品ガイド
   - `DEPLOYMENT_GUIDE.md` - デプロイ手順書（詳細版）
   - `HANDOVER.md` - このファイル

3. **Google Sheets APIの認証情報**
   - サービスアカウントのJSONファイル
   - または、新しいサービスアカウントを作成する手順

4. **スプレッドシートの情報**
   - スプレッドシートのID
   - スプレッドシートへのアクセス権限

5. **初期ユーザー情報**
   - 管理者アカウントのIDとパスワード
   - テストユーザーのIDとパスワード（オプション）

## 🔄 引き継ぎ手順

### ステップ1: GitHubリポジトリの移譲

#### 方法A: リポジトリを納品先のアカウントに移譲

1. GitHubリポジトリの「Settings」→「General」→「Danger Zone」
2. 「Transfer ownership」をクリック
3. 納品先のGitHubアカウント名を入力
4. 確認して移譲

#### 方法B: 納品先にアクセス権限を付与

1. GitHubリポジトリの「Settings」→「Collaborators」
2. 納品先のGitHubアカウントを追加
3. 権限を「Admin」に設定

### ステップ2: Railwayアカウントの引き継ぎ

#### 方法A: プロジェクトの所有権を移譲（推奨）

1. 開発者がRailwayのプロジェクト画面で「Settings」→「Team」を開く
2. 納品先のメールアドレスを招待
3. 納品先が招待を受け入れる
4. 納品先を「Owner」に変更
5. 開発者側のアクセスを削除（オプション）

#### 方法B: 納品先が新規にデプロイ（推奨）

1. 納品先が新しいRailwayアカウントを作成
2. `DEPLOYMENT_GUIDE.md` に従ってデプロイ
3. 環境変数とサービスアカウントJSONを設定
4. デプロイ完了後、開発者側のデプロイを停止

### ステップ3: Google Sheets APIの引き継ぎ

#### 方法A: 既存のサービスアカウントを引き継ぎ

1. サービスアカウントのJSONファイルを納品先に提供
2. 納品先がスプレッドシートへのアクセス権限を確認

#### 方法B: 新しいサービスアカウントを作成（推奨）

1. 納品先がGoogle Cloud Consoleで新しいプロジェクトを作成
2. 新しいサービスアカウントを作成
3. サービスアカウントのJSONファイルをダウンロード
4. スプレッドシートに新しいサービスアカウントのメールアドレスを追加
5. 古いサービスアカウントのアクセス権限を削除（オプション）

### ステップ4: スプレッドシートの引き継ぎ

1. スプレッドシートの所有権を納品先に移譲
   - スプレッドシートの「共有」→「詳細設定」→「所有権を変更」
2. または、納品先が新しいスプレッドシートを作成
3. 既存のデータをエクスポート/インポート（必要に応じて）

### ステップ5: 環境変数の引き継ぎ

以下の環境変数のリストを納品先に提供：

```
GOOGLE_SHEETS_SPREADSHEET_ID=your_spreadsheet_id_here
GOOGLE_SHEETS_JSON_PATH=./service-account.json
PORT=3000
JWT_SECRET=your_jwt_secret_here
```

**注意**: `JWT_SECRET` は本番環境用の強力な文字列に変更することを推奨します。

### ステップ6: 動作確認

納品先が以下を確認：

- [ ] アプリケーションにアクセスできる
- [ ] ログインできる
- [ ] 打刻機能が動作する
- [ ] 管理者機能が動作する
- [ ] スプレッドシートにデータが記録される

## 📞 サポート期間

引き継ぎ後、一定期間のサポートを提供することを推奨します：

- **初期サポート期間**: 1-2週間
- **サポート内容**: 
  - デプロイのトラブルシューティング
  - 基本的な操作方法の説明
  - バグ修正（必要に応じて）

## 📝 引き継ぎチェックリスト

### 開発者側

- [ ] GitHubリポジトリを移譲またはアクセス権限を付与
- [ ] ドキュメント一式を提供
- [ ] 環境変数のリストを提供
- [ ] サービスアカウントJSONファイルを提供（または新規作成手順）
- [ ] スプレッドシートの所有権を移譲（または新規作成手順）
- [ ] 初期ユーザー情報を提供
- [ ] Railwayアカウントの引き継ぎ（または新規デプロイ手順）
- [ ] 動作確認を実施

### 納品先側

- [ ] GitHubリポジトリへのアクセス確認
- [ ] Railwayアカウントの作成（または引き継ぎ）
- [ ] デプロイの実施
- [ ] 環境変数の設定
- [ ] サービスアカウントJSONファイルの設定
- [ ] スプレッドシートの準備
- [ ] 動作確認の実施
- [ ] 初期ユーザーの作成

## 🆘 トラブルシューティング

### デプロイが失敗する

- 環境変数が正しく設定されているか確認
- サービスアカウントJSONファイルが正しくアップロードされているか確認
- ログを確認してエラーメッセージを確認

### ログインできない

- スプレッドシートの `Employees` シートにユーザーが存在するか確認
- パスワードハッシュが正しく設定されているか確認
- `is_active` が `TRUE` になっているか確認

### データが記録されない

- サービスアカウントにスプレッドシートの編集権限が付与されているか確認
- `AttendanceLog` シートが存在するか確認
- シートのヘッダーが正しいか確認

## 📚 関連ドキュメント

- `README.md` - 基本ドキュメント
- `SETUP.md` - セットアップガイド
- `DELIVERY.md` - 納品ガイド
- `DEPLOYMENT_GUIDE.md` - デプロイ手順書（詳細版）

